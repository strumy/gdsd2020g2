{% extends "base.twig" %}


{% block body %}


    <p>{{ body }}</p>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />


    <div class="s003">
      <form method="post" action="search_product.php">
        <div class="inner-form">
            <div class="input-field first-wrap">
            <div class="input-select">
              <select data-trigger="" name="categories" id="categories">
                <option value="">All Categories</option>
                <option value="Electronics">Electronics</option>
                <option value="Stationary">Stationary Equipment</option>
                <option value="Services">Services</option>
              </select>
            </div>
          </div>
          <div class="input-field second-wrap">
                <input id="text_input" type="text" placeholder="What are you looking for?" name="text_input">
          </div>
          <div class="input-field first-wrap">
            <div class="input-select">
              <select data-trigger="" name="sort_by" id="sort_by">
                <option value="Price">Price</option>
                <option value="title">Name</option>
              </select>
            </div>
          </div>
          <div class="input-field third-wrap">
            <button class="btn-search" type="submit" name="submit">
              <svg class="svg-inline--fa fa-search fa-w-16" aria-hidden="true" data-prefix="fas" data-icon="search" role="img" viewBox="0 0 512 512">
                <path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path>
              </svg>
            </button>
          </div>
        </div>
      </form>
    </div>
    <script src="static/js/extension/choices.js"></script>
    <script>
      const choices = new Choices('[data-trigger]',
      {
        searchEnabled: false,
        itemSelectText: '',
      });

    </script>

    {% if check_auth %}
    <div class="button-post-outer">
    
    <a class="button-post" href="create_product.php">Post an Item</a>
    </div>
        
    {% endif %}
    
    {% if result is defined %}
    <div class="market-grid">
        {% for r in result %}
        <ul class="market-item">
            <li>
                <a href="#" class="product-photo">
                {% for p in search_data_pictures %}
                    {% if p['directory'] == r['picture'] %}
                        {# {% for p2 in p['images'] %}
                            <img src={{ "#{p['directory'] ~ p2}" }}  height="130">
                        {% endfor %}  #}
                        <img src={{ "#{p['directory'] ~ p['images']|first}" }}  height="130">
                    {% endif %}
                {% endfor %} 
                </a>
                <h2><a href="#">{{ r['title']}}</a></h2>
                <a href="#" class="product-compare">{{ r['date_inserted']}}</a>
                <h3><a href="#">{{ r['market_category']}}</a></h2>
                
                <p class="product-description">{{ r['text_body']}}</p>
                <p>Status: {{ r['Status']}}</p>
                <a class="button-post" href="{% if session.get('is_authenticated') %}message.php?post_id={{ r['post_id'] }}&author_id={{ r['author_id'] }} {% else %} login.php?m=m{% endif %}">Contact Seller</a>
                <p class="product-price">{{ r['Price']}}&euro;</p>
            </li>
        </ul>
        {% endfor %}            
    
    </div> 
    
    {% endif %}
    

{% endblock %}

